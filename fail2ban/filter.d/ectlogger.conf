# Fail2Ban filter for ECTLogger
# 
# This filter matches authentication failures logged by ECTLogger.
# 
# Log format:
#   YYYY-MM-DD HH:MM:SS [WARNING] [AUTH] Authentication failed: <reason> - IP: <host>
#   YYYY-MM-DD HH:MM:SS [WARNING] [SECURITY] Banned user access attempt: <email> - IP: <host>
#   YYYY-MM-DD HH:MM:SS [WARNING] [SECURITY] Rate limit exceeded on <endpoint> - IP: <host>

[INCLUDES]
before = common.conf

[Definition]

# Match authentication failures
failregex = ^.*\[WARNING\] \[AUTH\] Authentication failed:.*- IP: <HOST>$
            ^.*\[WARNING\] \[SECURITY\] Banned user access attempt:.*- IP: <HOST>$
            ^.*\[WARNING\] \[SECURITY\] Rate limit exceeded.*- IP: <HOST>$

# Ignore successful authentications
ignoreregex = ^.*\[INFO\] \[AUTH\] Authentication successful.*$

# Date/time pattern (YYYY-MM-DD HH:MM:SS)
datepattern = ^%%Y-%%m-%%d %%H:%%M:%%S

[Init]
# DEV Notes:
# 
# To test the filter:
#   fail2ban-regex /var/log/ectlogger/app.log /etc/fail2ban/filter.d/ectlogger.conf
#
# Author: ECTLogger Team
